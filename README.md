# 한글 파일 읽기
한글(HWP) 파일을 일고 텍스트를 추출하는 과정은 복잡하다. 이는 한글 파일 형식이 일반적인 텍스트 파일 형식과 다르게, 다양한 구조와 압축 방식으로 저장되기 때문이다.

1. OLE 구조
한글 파일(.hwp)은 OLE(Object Linking and Embedding) 컨테이너 형식을 사용하여 저장된다. 이는 Microsoft의 복합 파일 바이너리 형식으로, 여러 개의 데이터 스트림과 스토리지를 하나의 파링 내에서 계층적으로 저장할 수 있다. 이를 처리하기 위해 olefile 라이브러리를 사용한다.
- OLE파일 구조 탐색 : 파일 내에서 스티림과 디렉토리를 나열하여 fileheader와 bodytext 섹션을 찾아야 한다. 이는 OLE 파일의 구조를 이해하고 탐색하는 데 필요한 단계이다.

2. 파일 형식 검증
: 한글 파일이 올바른 형식인지 확인하기 위해 'FileHeader'와 .\x05HwpSummaryInformation 스트림을 검사한다. 이는 파일이 올바른 HWP형식인지 확인하는 중요한 단계이다.

3. 압축 여부 확인
: HWP 파일은 압축된 형식으로 저장할 수 있다. 파일 헤더에서 압축 여부를 확인하고, 압축된 경우 이를 해제해야 한다. 이는 zlib 라이브러리를 사용하여 수행한다.

4. BodyText 섹션 처리
: 한글 파일의 본문 텍스트는 BodyText 스트림에 섹션별로 나우어 저장된다. 각 섹션을 순차적으로 읽어와야한다.

5. 데이터 압축 해제
: 압축된 경우, 각 섹션 데이터를 zlib을 사용하여 압축 해제한다.

6. 텍스트 추출
: HWP 파일의 본문 텍스트는 여러 레코드로 나뉘어 저장한다. 각 레코드는 헤더와 데이터를 포함하고 있으며, 특정 레코드 유형을 찾아 텍스트를 추출한다. 이는 struct 라이브러리를 사용하여 바이너리 데이터를 파싱하여 수행한다.
